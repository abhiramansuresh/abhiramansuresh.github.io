<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abhi's Portfolio</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="profile-animation.js" defer></script>
    <script src="wave-animation.js" defer></script>
</head>
<body>
    <div class="grid-overlay">
        <div class="grid-container">
            <div class="grid-column"></div>
            <div class="grid-column"></div>
            <div class="grid-column"></div>
            <div class="grid-column"></div>
            <div class="grid-column"></div>
        </div>
    </div>
    
    <button class="menu-button">
        <i class="fas fa-bars"></i>
    </button>
    <div class="overlay"></div>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="profile">
                <div class="profile-squares">
                    <div class="profile-square square-bottom"></div>
                    <div class="profile-square square-top">
                        <img src="assets/profile.jpg" alt="Profile" class="profile-image">
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress" style="width: 100%"></div>
                </div>
            </div>

            <nav class="navigation">
                <div class="nav-section">
                    <a href="#games" class="nav-item">
                        Games
                    </a>
                    <a href="#apps" class="nav-item">
                        Apps
                    </a>
                    <a href="#prototypes" class="nav-item">
                        Prototypes
                    </a>
                    <a href="https://pandasaan.itch.io" class="nav-item" target="_blank">
                        <i class="fas fa-arrow-up-right-from-square"></i> Others
                    </a>
                    <a href="https://abhiraman.tumblr.com" class="nav-item" target="_blank">
                        <i class="fas fa-arrow-up-right-from-square"></i> Scribbling
                    </a>
                    <a href="about.html" class="nav-item" id="about-link"> <!-- Changed href to about.html and added an ID -->
                        About
                    </a>
                </div>

                <div class="nav-section contact-section">
                    <a href="mailto:abhiraman@live.com" class="contact-icon" target="_blank">
                        <i class="fas fa-envelope"></i>
                    </a>
                    <a href="https://www.linkedin.com/in/abhiraman/" class="contact-icon" target="_blank">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://steamcommunity.com/id/pandasaan/" class="contact-icon" target="_blank">
                        <i class="fab fa-steam"></i>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Index Section -->
            <!-- In the index section -->
            <section id="index" class="section">
                <h1 class="large-text">Hey! I am <span class="highlight-box">Aaabhi</span></h1>
                <h3>I <span class="love">love</span> movies, design, playing / making games.</h3>
                <h3>Currently, designing experiences <a href="https://www.learningyogi.com" target="_blank">@LearningYogi</a></h3>
            </section>

            <!-- Games Section -->
            <section id="games" class="section">
                <h2 class="section-title">Games</h2>
                <p class="section-subtitle">Games I've developed professionally</p>
                
                <div class="projects-grid" id="games-container">
                    <!-- Games will be loaded dynamically -->
                </div>
            </section>

            <!-- Apps Section -->
            <section id="apps" class="section">
                <h2 class="section-title">Apps</h2>
                <p class="section-subtitle">Applications I've worked on professionally</p>
                
                <div class="projects-grid" id="apps-container">
                    <!-- Apps will be loaded dynamically -->
                </div>
            </section>

            <!-- Prototypes Section -->
            <section id="prototypes" class="section">
                <h2 class="section-title">Prototypes</h2>
                <p class="section-subtitle">Experimental projects and prototypes made for fun</p>
                
                <div class="projects-grid" id="prototypes-container">
                    <!-- Prototypes will be loaded dynamically -->
                </div>
            </section>

            <!-- New container for dynamically loaded content -->
            <section id="main-content-area">
                <!-- Content from about.html will be loaded here -->
            </section>
        </main>
    </div>

    <script>
        // Handle mobile menu
        document.querySelector('.menu-button').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
            document.querySelector('.overlay').classList.toggle('active');
        });

        document.querySelector('.overlay').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.remove('active');
            document.querySelector('.overlay').classList.remove('active');
        });

        // Handle smooth scrolling for anchor links - MODIFIED
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#index') {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    const section = document.querySelector(targetId);
                    if (section) {
                        section.scrollIntoView({ behavior: 'smooth' });
                    }
                }
                // Update active state
                document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // New JavaScript to handle loading about.html
        document.getElementById('about-link').addEventListener('click', function(e) {
            e.preventDefault();
            fetch('about.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('main-content-area').innerHTML = html;
                    // Hide other sections and show main-content-area
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.style.display = 'none';
                    });
                    document.getElementById('main-content-area').style.display = 'block';

                    // Remove active state from other nav items and add to 'About'
                    document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
                    this.classList.add('active');
                })
                .catch(error => console.error('Error loading about.html:', error));
        });

        // Update active section on scroll - MODIFIED to exclude dynamically loaded content
        const sections = document.querySelectorAll('section:not(#main-content-area)'); // Exclude the dynamic content area
        const navItems = document.querySelectorAll('.nav-item');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (pageYOffset >= sectionTop - sectionHeight / 3) {
                    current = section.getAttribute('id');
                }
            });

            navItems.forEach(item => {
                // Only update active state for internal links and not the about link
                if (item.getAttribute('href').startsWith('#') && item.getAttribute('id') !== 'about-link') {
                    item.classList.remove('active');
                    if (item.getAttribute('href') === `#${current}`) {
                        item.classList.add('active');
                    }
                }
            });
        });
    </script>
    <script src="js/theme.js"></script>
    <script src="js/projects.js"></script>
</body>
</html>